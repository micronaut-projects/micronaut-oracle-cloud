plugins {
    id 'io.micronaut.build.internal.oraclecloud-native-tests'
}

dependencies {
    annotationProcessor("io.micronaut.serde:micronaut-serde-processor")
    implementation libs.fn.api
    runtimeOnly libs.fn.runtime
    implementation(projects.micronautOraclecloudFunction)
    implementation(projects.micronautOraclecloudHttpclientNetty)
    testImplementation libs.fn.testing.junit4
}

application {
    mainClass = "com.fnproject.fn.runtime.EntryPoint"
}

graalvmNative.toolchainDetection = false
graalvmNative {
    binaries.configureEach {
        buildArgs.addAll(
                "-H:+StaticExecutableWithDynamicLibC",
                "-Dfn.handler=example.Function::handleRequest",
                "--initialize-at-build-time=example",
        )
    }
}
