import io.micronaut.gradle.docker.DockerBuildStrategy

plugins {
    id 'io.micronaut.build.internal.oraclecloud-example'
    id 'groovy'
}

dependencies {
    implementation 'io.micronaut.groovy:micronaut-runtime-groovy'
    implementation projects.oraclecloudFunction
    runtimeOnly libs.fn.runtime
    runtimeOnly mn.slf4j.simple
    testAnnotationProcessor mn.micronaut.inject.groovy
    testImplementation libs.fn.testing.junit4
    testImplementation mn.micronaut.test.spock
    testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine'
}

project.afterEvaluate {
    nativeCompile.enabled = false
    testNativeImage.enabled = false
}

application.mainClass.set 'com.fnproject.fn.runtime.EntryPoint'

dockerfile {
    buildStrategy.set(DockerBuildStrategy.ORACLE_FUNCTION)
    defaultCommand.set('example.ListBucketsFunction::handleRequest')
}

run {
    args('example.ListBucketsFunction::handleRequest')
}
